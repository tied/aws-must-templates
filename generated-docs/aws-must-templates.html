<p><style>
h1 {
    color:blue; 
    font-size: 2.5em;
   }
h2 {
      color:blue;
      font-size: 1.5em;
   }
h3 {
      color:blue;
      font-size: 1.5em;
   }
.navigator {
      font-size: 0.5em;
   }
body {
    background-color: #b0c4de;
} 
/* Support fold-on/fold-off toggle */
div.fold { 
    width: 90%; padding: .42rem; border-radius: 5px;  margin: 1rem; </p>

<p>}
div.fold div { 
       height: 0px; margin: .2rem; overflow: hidden; 
}
div.toggle ~ div { height: 0px; margin: .2rem; overflow: hidden; }
input.toggle:checked ~ div { 
     height: auto; <br />
     color: white; 
     background: #c6a24b;
     font-family: monospace;
     white-space: pre; 
}
</style></p>

<h1><a id="top"/><a href="https://github.com/jarjuk/aws-must-templates">aws-must-templates</a></h1>

<p>Templates for <code>aws-must</code> tool.</p>

<h2>Table of contents</h2>

<ul>

    <li><a href="#root.mustache">root.mustache</a>: root template = starting point of template rendering</li>

    <li><a href="#parameter.mustache">parameter.mustache</a>: create one parameter entry to CloudFormation JSON parameter section</li>

    <li><a href="#mappings.mustache">mappings.mustache</a>: matches a key to a corresponding set of named values</li>

    <li><a href="#mappingSubnetConfig.mustache">mappingSubnetConfig.mustache</a>: subnet config mapping to map VPC/Public/Private key to CIDR subnet block.</li>

    <li><a href="#resource.mustache">resource.mustache</a>: dispatch resource based on resource type</li>

    <ul> 

        <li><a href="#resourceSecurityGroup.mustache">resourceSecurityGroup.mustache</a>: create an security group for accessing EC2 instances</li>

        <li><a href="#resourceS3Bucket.mustache">resourceS3Bucket.mustache</a>: create an S3 Bucket</li>

        <li><a href="#resourceRole.mustache">resourceRole.mustache</a>: AWS Identity and Access Management (IAM) role.</li>

        <li><a href="#resourcePolicy.mustache">resourcePolicy.mustache</a>: lists permissions to be assigned to a user, group, role, or resource</li>

        <li><a href="#resourceWait.mustache">resourceWait.mustache</a>: Creates a WaitHandle, and a WaitCondition on a resource `DependsOn`</li>

        <li><a href="#resourceVPC.mustache">resourceVPC.mustache</a>: Creates a Virtual Private Cloud (VPC) with a CIDR block</li>

        <li><a href="#resourceSubnet.mustache">resourceSubnet.mustache</a>: Creates a subnet in an existing VPC</li>

        <li><a href="#resourceInternetGateway.mustache">resourceInternetGateway.mustache</a>: a new Internet gateway in your AWS account</li>

        <li><a href="#resourceUser.mustache">resourceUser.mustache</a>: Creates User and AccessKey resources. User resource is associated with a fixed policy</li>

        <li><a href="#resourceStack.mustache">resourceStack.mustache</a>: Nests a stack as a resource in a top-level template.</li>

        <li><a href="#resourceInstanceProfile.mustache">resourceInstanceProfile.mustache</a>: a container for an IAM role and enables you to pass role information to an Amazon EC2 instance when the instance starts</li>

        <li><a href="#resourceInstance.mustache">resourceInstance.mustache</a>: create an EC2 instance</li>

        <ul>

            <li><a href="#tag.mustache">tag.mustache</a>: add key-value tag property to an</li>

            <li><a href="#resourceInstanceInitialize.mustache">resourceInstanceInitialize.mustache</a>: user-data script</li>

            <li><a href="#initializeInstallChef.mustache">initializeInstallChef.mustache</a>: UserData -script to install Chef</li>

            <li><a href="#initializeInstallAwsCli.mustache">initializeInstallAwsCli.mustache</a>: UserData -script to install AwsCli</li>

            <li><a href="#initializeProvisionChef.mustache">initializeProvisionChef.mustache</a>: UserData -script to provision Chef</li>

            <li><a href="#initializeCFtools.mustache">initializeCFtools.mustache</a>: Ubuntu CloudFormation Tools installation snippet</li>

        </ul> <!-- resoureceInstance sub-templates -->

    </ul> <!-- resource.mustache -->

    <li><a href="#output.mustache">output.mustache</a>: values in response to describe stack calls </li> 

    <li>Common templates</li> 

    <ul> 

        <li><a href="#commonInstanceType.mustache">commonInstanceType.mustache</a>: Output value for `InstanceType` -attribute</li> 

        <li><a href="#commonValue.mustache">commonValue.mustache</a>: Common template to output value (Value/Ref/Attr/StackRef)</li> 

        <li><a href="#commonKeyValue.mustache">commonKeyValue.mustache</a>: Common template output key value pairs</li> 

        <li> <a href="#commonDependsOn.mustache">commonDependsOn.mustache</a>: </li>

        <li> <a href="#commonCreationPolicy.mustache">commonCreationPolicy.mustache</a>: </li>

        <li> <a href="#commonCfnSignal.mustache">commonCfnSignal.mustache</a>: </li>

        <li> <a href="#commonStackRef.mustache">commonStackRef.mustache</a>: </li>

    </ul> 

</ul>

<h2><a id="root.mustache"></a>root.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Starting point of template rendering.</p>

<p><strong>Attributes</strong>: context= <code>.</code></p>

<ul>
<li><code>description</code>: description for the CF template</li>
<li><code>parameters</code>: array of parameter sub-documents for CloudFormation Parameters -section</li>
<li><code>resources</code>: array of resource sub-documents for CloudFormation Resources -section</li>
<li><code>outputs</code>: array of output sub-documents for CloudFormation Outputs -section</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{
  "AWSTemplateFormatVersion" : "2010-09-09",

  "Description" : "{{description}}",

  "Parameters" : {
    {{# parameters }}{{> parameter }}{{/ parameters }}
  },

  "Mappings" : {
    {{> mappings }}
    {{# mappings.length }},{{/ mappings.length }}
    {{# mappings }}{{> mapping }}{{/ mappings }}
   },

  "Resources" : {

    {{> resources }}
    {{# resources }}{{> resource }}{{/ resources }}

  },

  "Outputs" : {

    {{# outputs }}{{> output }}{{/ outputs }}

  }

}

</div></div>

<h2><a id="parameter.mustache"></a>parameter.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Create one parameter entry to CloudFormation JSON parameter section</p>

<p><strong>Attributes</strong>: context= <code>./parameters</code></p>

<ul>
<li><code>Name</code> : of the ouput entry</li>
<li><code>Description</code>: of the parameter entry</li>
<li>One of 
<ul>
<li><code>Value</code>: value of the parameter</li>
<li><code>NestedValue</code>: 
<ul>
<li><code>Stack</code> : resource name of the nested stack</li>
<li><code>Output</code>: name of output variable in nested stack</li>
</ul></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

    "{{Name}}": {
      "Description" : "{{Description}}{{^Description}}No description given{{/Description}}"
      , "Type": "{{Type}}"
      {{#Value}}, "Default" : "{{Value}}"{{/Value}}
    }{{_comma}}

</div></div>

<h2><a id="mappings.mustache"></a>mappings.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Create fixed lookup tables <code>AWSInstanceType2Arch</code> and
<code>AWSRegionArch2AMI</code> implementing the table below</p>

<p><code><pre>
ap-northeast-1    trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-90815290    hvm
ap-southeast-1    trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-0accf458    hvm
ap-southeast-2    trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-1dc8b127    hvm
cn-north-1        trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-eae27fd3    hvm
eu-central-1      trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-3248712f    hvm
eu-west-1         trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-d74437a0    hvm
sa-east-1         trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-0f6ced12    hvm
us-east-1         trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-83c525e8    hvm
us-gov-west-1     trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-51513172    hvm
us-west-1         trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-61b25925    hvm
us-west-2         trusty    14.04 LTS    amd64    hvm:ebs-ssd    20150528    ami-57e8d767    hvm
</pre></code></p>

<p><strong>Attributes</strong>: context=  <code>.</code></p>

<ul>
<li>none</li>
</ul>

<p><strong>Actions</strong>:</p>

<ul>
<li><p><strong>AWSInstanceType2Arch</strong>: fixed key/value mapping, currently only
<strong>t2.micro</strong> --> <strong>64bit</strong></p></li>
<li><p><strong>AWSRegionArch2AMI</strong>: fixed key/value mapping created, currently
architectures only for <strong>64bits</strong></p></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

      "AWSInstanceType2Arch" : {
      "t2.micro"    : { "Arch" : "64" }
      },
      "AWSRegionArch2AMI" : {
           "ap-northeast-1" : { "64" : "ami-90815290" },
           "ap-southeast-1" : { "64" : "ami-0accf458" },
           "ap-southeast-2" : { "64" : "ami-1dc8b127" },
           "cn-north-1" : { "64" : "ami-eae27fd3" },
           "eu-central-1" : { "64" : "ami-3248712f" },
           "eu-west-1" : { "64" : "ami-d74437a0" },
           "sa-east-1" : { "64" : "ami-0f6ced12" },
           "us-east-1" : { "64" : "ami-83c525e8" },
           "us-west-1" : { "64" : "ami-61b25925" },
           "us-gov-west-1" : { "64" : "ami-51513172" },
           "us-west-2" : { "64" : "ami-57e8d767" }
      }



</div></div>

<h2><a id="mapping.mustache"></a>mapping.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Dispatches mapping sub-type templates based mapping Type propertys</p>

<p><strong>Attributes</strong>: context=  <code>./mappings</code></p>

<ul>
<li><code>SubnetConfig</code>: </li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{{# SubnetConfig }}{{> mappingSubnetConfig }}{{/ SubnetConfig }}


</div></div>

<h2><a id="mappingSubnetConfig.mustache"></a>mappingSubnetConfig.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Creates a subnet config mapping to map VPC/Public/Private key to CIDR
subnet block.</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Name</code>: of the mapping</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

"{{Name}}" : {
      "VPC"     : { "CIDR" : "10.44.0.0/16" },
      "Public"  : { "CIDR" : "10.44.0.0/24" },
      "Private" : { "CIDR" : "10.44.1.0/24" }
 }{{_comma}}

</div></div>

<h2><a id="resources.mustache"></a>resources.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Empty template.</p>

<p><strong>Attributes</strong>: context=  <code>.</code></p>

<ul>
<li>none</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{{!

"S3AccessRole" : {
    "Type"  : "AWS::IAM::Role",
    "Properties" : {
        "AssumeRolePolicyDocument" : {
            "Statement" : [ {
                "Effect" : "Allow",
                "Principal" : {
                    "Service" : [ "ec2.amazonaws.com" ]
                },
                "Action" : [ "sts:AssumeRole" ]
            } ]
        },
        "Path" : "/"
    }
},


"S3RolePolicies" : {
    "Type" : "AWS::IAM::Policy",
    "Properties" : {
        "PolicyName" : "s3access",
        "PolicyDocument" : {
            "Statement" : [ {
                "Effect" : "Allow",
                "Action" : "s3:*",
                "Resource" : "*"
            }]
        },
        "Roles" : [ { "Ref" : "S3AccessRole" } ]
    }
},

"S3InstanceProfile" : {
    "Type" : "AWS::IAM::InstanceProfile",
    "Properties" : {
        "Path" : "/",
        "Roles" : [ { "Ref" : "S3AccessRole" } ]
    }
},

}}

</div></div>

<h2><a id="resource.mustache"></a>resource.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Dispatches resource sub-type templates based resource Type propertys</p>

<p><strong>Attributes</strong>: context=  <code>./resources</code></p>

<ul>
<li><code>Instance</code>: sub-document defining an EC instance</li>
<li><code>SecurityGroup</code>: sub-document defining an <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html">AWS::EC2::SecurityGroup</a></li>
<li><code>S3Bucket</code>: </li>
<li><code>Role</code>: </li>
<li><code>Policy</code>: </li>
<li><code>InstanceProfile</code>: </li>
<li><code>Stack</code>: </li>
<li><code>Wait</code>: </li>
<li><code>VPC</code>: </li>
<li><code>InternetGateway</code>: </li>
<li><code>Subnet</code>: </li>
<li><code>User</code>: creates <a href="#resourceUser.mustache">User</a></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{{# Instance }}{{> resourceInstance}}{{/ Instance }}
{{# SecurityGroup }}{{> resourceSecurityGroup}}{{/ SecurityGroup }}
{{# S3Bucket }}{{> resourceS3Bucket }}{{/ S3Bucket }}
{{# Role }}{{> resourceRole }}{{/ Role }}
{{# Policy }}{{> resourcePolicy }}{{/ Policy }}
{{# InstanceProfile }}{{> resourceInstanceProfile }}{{/ InstanceProfile }}
{{# Stack }}{{> resourceStack }}{{/ Stack }}
{{# Wait }}{{> resourceWait }}{{/ Wait }}
{{# VPC }}{{> resourceVPC }}{{/ VPC }}
{{# Subnet }}{{> resourceSubnet }}{{/ Subnet }}
{{# InternetGateway }}{{> resourceInternetGateway }}{{/ InternetGateway }}
{{# User }}{{> resourceUser  }}{{/ User }}



</div></div>

<h2><a id="resourceInstance.mustache"></a>resourceInstance.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Create an EC2 instance</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Instance</code></p>

<ul>
<li><code>Name</code>: name of the EC2 instance to create</li>
<li>Instance type
<ul>
<li><code>InstanceType</code> : The instance type, such as t2.micro. </li>
<li><code>InstanceTyperef</code> : Reference to instance type</li>
</ul></li>
<li><code>tags</code> : array of tag sub-documents for EC2 instance</li>
<li><code>SecurityGroupIds</code>: array of <a href="#commonValue.mustache">commonValue.mustache</a></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

    "{{Name}}" : {
      "Type" : "AWS::EC2::Instance"
      {{> commonCreationPolicy }}
      , "Metadata": {
            {{> resourceInstanceMetadata }}

      } {{! metadata }}
      , "Properties" : {
          "ImageId" : { "Fn::FindInMap" : [ "AWSRegionArch2AMI", { "Ref" : "AWS::Region" },
                      { "Fn::FindInMap" : [ "AWSInstanceType2Arch", {{> commonInstanceType }}, "Arch" ] } ] }
          , "InstanceType" : {{> commonInstanceType}} {{! InstanceType OR InstanceTypeRef }}
          , "Tags" : [ {{#tags}}{{>tag}}{{/tags}} ]
          , "SecurityGroupIds" : [ 
                {{# SecurityGroupIds }}
                    {{> commonValue }}{{_comma}}
                {{/ SecurityGroupIds }}
          ]
          {{#IamInstanceProfile}}, "IamInstanceProfile" : { "Ref" : "{{IamInstanceProfile}}" }{{/ IamInstanceProfile}}
          {{# SubnetId }}, "SubnetId": {{> commonValue }} {{/ SubnetId }}
          {{#KeyName}}, "KeyName" : { "Ref" : "{{KeyName}}" }{{/KeyName}}
          , "UserData": {{> resourceInstanceInitialize }}
      }
    }{{_comma}}


</div></div>

<h2><a id="tag.mustache"></a>tag.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>One key-value pair in EC2 instance Tags -array</p>

<p><strong>Attributes</strong>: context= <code>./resources/Instance/tags</code></p>

<ul>
<li><code>Key</code>: of the tag entry</li>
<li><code>Value</code>: of the tag entry</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{ "Key" : "{{Key}}",  "Value" : "{{Value}}"{{_comma}} }

</div></div>

<h2><a id="resourceInstanceMetadata.mustache"></a>resourceInstanceMetadata.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>The Metadata attribute enables you to associate structured data with a
resource. By adding a Metadata attribute to a resource, you can add
data in JSON format to the resource declaration.</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Initialize</code>: array of
<ul>
<li><code>StartCfnHup</code>: see <a href="#initializeCfnInitHupFiles.mustache">initializeCfnInitHupFiles</a></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{{! NOTICE: check for 'resourceInstanceInitialize.mustache' for using
  '#Initialize' array to setup `UserData` -script }}

{{# Initialize.length }}
"AWS::CloudFormation::Init":{
   "config" : {
     "packages" : {
     },
     "groups" : {
     },
     "users" : {
     },
     "sources" : {
     },
     "files" : {
        "/tmp/cfn-init.txt": {
               "content":{
                   "Fn::Join":["", [ "Installed in cfn-init", "\n" ]]
                }
               , "mode":"000444"
               , "owner":"root"
               , "group":"root"
        }
        {{# Initialize }}{{# StartCfnHup }}, {{> initializeCfnInitHupFiles }}{{/ StartCfnHup }}{{/ Initialize }}
     },
     "commands" : {
     },
     "services" : {
     }
  }

} {{! AWS::CloudFormation::Init" }}
{{/ Initialize.length }}

{{! Add a metadata field, which, when updated, triggers cfn-hup. c.f. initializeCfnInitHupFiles }}
{{# Initialize }}{{# StartCfnHup }}
,    "CfnHup": "updating this field causes cfn-hup to trigger"
{{/ StartCfnHup }}{{/ Initialize }}





</div></div>

<h2><a id="resourceInstanceInitialize.mustache"></a>resourceInstanceInitialize.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>user-data script</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>CreationPolicy</code>: in the end send cfn-signal to <code>../Name</code> -resource in current stack </li>
<li><code>InitializeWait</code>: name of wait resource (for successfull script)</li>
<li><code>Initialize</code> : array of 
<ul>
<li><code>InstallCFtools</code>: </li>
<li><code>ProvisionChef</code>: </li>
<li><code>InstallChef</code>: add UserData to install Chef</li>
<li><code>InstallAwsCli</code>: add UserData to install awscli</li>
<li><code>LaunchChefZero</code>: </li>
<li><code>StartCfnInit</code>: <a href="#initializeCFinit.mustache">Launch cfn-init</a></li>
<li><code>StartCfnHup</code>: <a href="#initializeStartCfnHup.mustache">launch cfn-hup helper</a></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


{ "Fn::Base64": { "Fn::Join": [ "\n",
                  [
                    "#!/bin/bash\n"
                  , "set -x\n"
                  , "set -e\n"
                  , "set -o pipefail\n"
          , "LOG=/tmp/install.log\n"
                  , "echo $(date): starting to install chef  > $LOG\n"
                  , "function finish() {\n"
          ,        "    echo \"$(date): installation finished\"  \n"
                           {{# CreationPolicy}}
                  ,        "    STACK='", { "Ref" : "AWS::StackName" }, "'\n"
                  ,        "    REGION='", { "Ref" : "AWS::Region" }, "'\n"
                  ,        "    RESOURCE='{{Name}}'\n"
                  ,        "    type cfn-signal && sudo cfn-signal --success true  --reason \"UserData script success\" --stack $STACK --resource $RESOURCE --region $REGION \n"
                           {{/ CreationPolicy}}
                           {{# InitializeWait}}
                  ,        "    HANDLE='", { "Ref" : "{{InitializeWait}}" }, "'\n"
                  ,        "    type cfn-signal && sudo cfn-signal --success true  --reason \"UserData script success\" $HANDLE  \n"
                           {{/ InitializeWait}}
                  ,  "}\n" 
                  , "function error() {\n"
                  ,        "    local lineno=$1\n"
                  ,        "    local error=1\n"
                           {{# CreationPolicy}}
                  ,        "    STACK='", { "Ref" : "AWS::StackName" }, "'\n"
                  ,        "    REGION='", { "Ref" : "AWS::Region" }, "'\n"
                  ,        "    RESOURCE='{{Name}}'\n"
                  ,        "    type cfn-signal && sudo cfn-signal --exit-code $error  --reason \"installation finished in ERROR on line $lineno\" --stack $STACK --resource $RESOURCE --region $REGION \n"
                           {{/ CreationPolicy}}
                           {{# InitializeWait}}
                  ,        "    HANDLE='", { "Ref" : "{{InitializeWait}}" }, "'\n"
                  ,        "    type cfn-signal && sudo cfn-signal --exit-code $error  --reason \"installation finished in ERROR on line $lineno\" $HANDLE  \n"
                           {{/ InitializeWait}}
          ,        "    echo \"$(date): installation finished in ERROR $error on line $lineno\"  \n"
                  ,        "    exit 1\n"
                  ,  "}\n" 
                  , "trap finish EXIT\n"
                  , "trap 'error ${LINENO}' ERR\n"

{{! NOTICE:  check for resourceInstanceMetadata.mustache   }}


                {{# Initialize}}
                {{# InstallCFtools }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Install Cloudformation tools   \n"
                           {{> initializeCFtools }} 
                    {{/ InstallCFtools }}
                {{#ProvisionChef }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Provision chef   \n"
                           {{> initializeProvisionChef }} 
                    {{/ ProvisionChef }}
                {{#InstallAwsCli }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Install AWS client tools   \n"
                          {{> initializeInstallAwsCli }}
                    {{/ InstallAwsCli }}
                {{#InstallChef }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Install chef   \n"
                           {{> initializeInstallChef }} 
                    {{/ InstallChef }}
                {{#LaunchChefZero }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Lauch ChefZero   \n"
                           {{> initializeProvisionChefZero }} 
                    {{/ LaunchChefZero }}
                {{# StartCfnInit }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Start cfn-init   \n"
                           {{> initializeCFinit }} 
                    {{/ StartCfnInit }}
                {{# StartCfnHup }}
                    ,      "echo \"$(date): ------------------------------------------------------------------\"   \n"
                    ,      "echo Start cfn-hup   \n"
                           {{> initializeStartCfnHup }} 
                    {{/ StartCfnHup }}
                {{/ Initialize}}
                ]

           ]}
       } 

</div></div>

<h2><a id="initializeInstallChef.mustache"></a>initializeInstallChef.mustache<a class='navigator' href='#top'> [top]</a></h2>

<p>UserData -script to install Chef</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Version</code>: Chef version to install</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

                 {{# Version}}
                    {{# Ref}}
             ,  "CHEF_VERSION='", { "Ref": "{{Ref}}" }, "'\n"
                    {{/ Ref}}
                    {{^ Ref}}
             ,  "CHEF_VERSION={{Version}}\n"
                    {{/ Ref}}
                 {{/ Version}}
                 ,  "echo $(date): starting to install chef  \n"
         ,  "curl -L https://www.chef.io/chef/install.sh | sudo bash -s -- -v $CHEF_VERSION   \n"
                 ,  "echo $(date): chef installed successfully \n"





</div></div>

<h2><a id="initializeInstallAwsCli.mustache"></a>initializeInstallAwsCli.mustache<a class='navigator' href='#top'> [top]</a></h2>

<p>UserData -script to install AwsCli </p>

<p><strong>Attributes</strong>: context=  <code>./resources/Instance/InstallChef</code></p>

<ul>
<li>None</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

                   , "TMP_ZIP=awscli-bundle.zip\n"
                   , "curl https://s3.amazonaws.com/aws-cli/awscli-bundle.zip -o $TMP_ZIP\n"
                   , "sudo apt-get install unzip\n"
                   , "unzip $TMP_ZIP -d /tmp\n"
                   , "cd /tmp\n"
                   , "sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws  \n"
                   , "echo $(date): awscli installed successfully \n"


</div></div>

<h2><a id="initializeProvisionChefZero.mustache"></a>initializeProvisionChefZero.mustache<a class='navigator' href='#top'> [top]</a></h2>

<p>Read Chef kithen from S3 bucket &amp;&amp; launch chef zero</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Instance/LaunchChefZero</code></p>

<ul>
<li><code>BucketName</code>: S3 bucket containing kitchen to provision</li>
<li><code>WaitHandle</code>: to inform once ChefZero booted</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

         ,  "KITCHEN=/tmp/setup\n"
                 ,  "echo $(date): copy s3 bucket {{BucketName}} to $KITCHEN \n"
                 ,  "aws s3 cp --recursive  --region $(aws s3api get-bucket-location --bucket {{BucketName}} --output text) s3://{{BucketName}}/setup/  $KITCHEN\n"
                 ,  "echo $(date): install chef-zero \n"
                 ,  "sudo apt-get install -y chef-zero  \n"
                 ,  "echo $(date): start ChefZero in the background\n"
                 ,  "chef-zero --host 0.0.0.0 -d\n"
                 ,  "echo $(date): upload kithchen \n"
                 ,  "cd $KITCHEN && knife upload .\n"
                 ,  "echo $(date): kitchen uploaded \n"




</div></div>

<h2><a id="initializeCFtools.mustache"></a>initializeCFtools.mustache<a class='navigator' href='#top'> [top]</a></h2>

<p>An <a href="https://gist.github.com/kixorz/10194688">adapted</a> Ubuntu
CloudFormation Tools installation snippet.</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li>none</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>
  ,    "sudo apt-get -y install python-setuptools  \n"
  ,    "[ -d aws-cfn-bootstrap-latest  ] || mkdir aws-cfn-bootstrap-latest  \n"
  ,    "curl https://s3.amazonaws.com/cloudformation-examples/aws-cfn-bootstrap-latest.tar.gz | tar xz -C aws-cfn-bootstrap-latest --strip-components 1  \n"
  ,    "sudo easy_install aws-cfn-bootstrap-latest  \n"

</div></div>

<h2><a id="resourceSecurityGroup.mustache"></a>resourceSecurityGroup.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Create an EC2 Security Group</p>

<p><strong>Attributes</strong>: context=  <code>./resources/SecurityGroup</code></p>

<ul>
<li><code>Name</code> : of the security group</li>
<li><code>VpcId</code>: The Reference name physical ID of the VPC.  given as commonValue, <a href="#commonValue.mustache">commonValue.mustache</a></li>
<li><code>SecurityGroupIngress</code>: Arrays in a SecurityGroupIngr
<ul>
<li><code>IpProtocol</code>: default tcp</li>
<li><code>FromPort</code>: default to <code>Port</code></li>
<li><code>ToPort</code>: defaults to <code>Port</code></li>
<li>CidrIp given as commonValue, <a href="#commonValue.mustache">commonValue.mustache</a></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

    "{{Name}}" : {
      "Type" : "AWS::EC2::SecurityGroup",
      "Properties" : {
        "GroupDescription" : "Enable SSH access via port 22"
        {{# VpcId }}, "VpcId": {{> commonValue }} {{/ VpcId }}
        , "SecurityGroupIngress" : [ 
                {{# SecurityGroupIngress }}
                     {
                         "IpProtocol" : {{#IpProtocol}}"{{IpProtocol}}"{{/IpProtocol}}{{^IpProtocol}}"tcp"{{/IpProtocol}},
                         "FromPort" : "{{#FromPort}}{{FromPort}}{{/FromPort}}{{^FromPort}}{{Port}}{{/FromPort}}",
                         "ToPort" : "{{#ToPort}}{{ToPort}}{{/ToPort}}{{^ToPort}}{{Port}}{{/ToPort}}",
                         "CidrIp" : {{> commonValue }}
                    } {{_comma}}
                {{/ SecurityGroupIngress }}
        ]
      }
    }{{_comma}}

</div></div>

<h2><a id="resourceS3Bucket.mustache"></a>resourceS3Bucket.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Create an S3 Bucket - with default 'PublicRead'</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Instance</code></p>

<ul>
<li><code>Name</code>: name of the S3 resource to create</li>
<li><code>BucketName</code>: A name for the bucket. If you don't specify a name,
AWS CloudFormation generates a unique physical ID and uses that ID
for the bucket name.</li>
<li><code>DeletionPolicy</code>: attribute you can preserve or (in some cases) backup
a resource when its stack is deleted. Valid values <code>Delete</code>,
<code>Retain</code> (default), <code>Snapshot</code></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


    "{{Name}}" : {
      "Type" : "AWS::S3::Bucket"
      {{> commonCreationPolicy }}
      , "DeletionPolicy" : "{{# DeletionPolicy }}{{DeletionPolicy}}{{/ DeletionPolicy}}{{^ DeletionPolicy }}Retain{{/ DeletionPolicy}}"
      , "Properties" : {
          {{# BucketName }} "BucketName" : "{{BucketName}}" {{/ BucketName }}
          {{! 
              ,"LifecycleConfiguration": {  "Rules" : [ ] }
          }}
      }
    }{{_comma}}

</div></div>

<h2><a id="resourceRole.mustache"></a>resourceRole.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>AWS Identity and Access Management (IAM) role.</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Instance</code></p>

<ul>
<li><code>Name</code>: name of the Role to create</li>
<li><code>Resource</code>: resources you allow the action on</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


    "{{Name}}" : {
      "Type" : "AWS::IAM::Role"
      , "Properties" : {
        "Path" : "/",
        "AssumeRolePolicyDocument" : {
            "Statement" : [ {
                "Effect" : "Allow",
                "Principal" : {
                    "Service" : [ "ec2.amazonaws.com" ]
                },
                "Action" : [ "sts:AssumeRole" ]
            } ]
        }
      }
    }{{_comma}}

</div></div>

<h2><a id="resourceInstanceProfile.mustache"></a>resourceInstanceProfile.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>a container for an IAM role and enables you to pass role information to an Amazon EC2 instance when the instance starts</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Instance</code></p>

<ul>
<li><code>Name</code>: name of the InstanceProfile  to create</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


  "{{Name}}" : {
    "Type" : "AWS::IAM::InstanceProfile",
    "Properties" : {
      "Path" : "/",
      "Roles" : [{{# Roles}}{ "Ref": "{{Ref}}"}{{_comma}}{{/ Roles}} ]
    }
  },




</div></div>

<h2><a id="resourcePolicy.mustache"></a>resourcePolicy.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>To assign permissions to a user, group, role, or resource, you create
a policy, which is a document that explicitly lists permissions.</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Policy</code></p>

<ul>
<li><code>Name</code>: name of the Role to create</li>
<li><code>Statements</code> array of
<ul>
<li><code>Effect</code>: Allow/Deny</li>
<li><code>Action</code>: list of actions for the policy</li>
<li><code>Resource</code>: array of <a href="#commonValue.mustache">commonValues</a> concatenated to create resource reference</li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

"{{Name}}" : {
    "Type" : "AWS::IAM::Policy",
    "Properties" : {
        "PolicyName" : "{{Name}}",
        "Roles" : [ { "Ref" : "{{RoleRef}}" } ],
        "PolicyDocument" : {
            "Statement" : [ 
                 {{# Statements }} 
                 {
                    "Effect" : "{{Effect}}",
                    "Action" : [ {{{Actions}}} ],
                    "Resource" : 
                      {{^ Resource.length }} "{{ Resource }}" {{/ Resource.length }} 
                      {{# Resource.length }} {  "Fn::Join" : [ "", [ {{/ Resource.length }} 
                         {{# Resource }}{{> commonValue }}{{ _comma }} {{/ Resource}}
                      {{# Resource.length }}] ] } {{/ Resource.length }} 
                 }{{_comma}}
                 {{/ Statements }}
            ]
        }
    }
}{{_comma}}


</div></div>

<h2><a id="resourceStack.mustache"></a>resourceStack.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p>Nests a stack as a resource in a top-level template.</p>

<p><strong>Attributes</strong>: context=  <code>./resources/Policy</code></p>

<ul>
<li><code>Name</code>: resource name given to the nested stack</li>
<li><code>TemplateFile</code>: local path used to create <code>TemplateUrl</code> for AWS::CloudFormation::Stack</li>
<li><code>DependsOn</code>: With the DependsOn attribute you can specify that the
creation of a specific resource follows another</li>
<li><code>Parameters</code> Array of  sub documents
<code>Key</code>
<code>Value</code> </li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

"{{Name}}" : {
    "Type" : "AWS::CloudFormation::Stack"
    {{> commonDependsOn }}
    , "Properties" : {
            "TemplateURL": "{{TemplateURL}}"
          , "Parameters" : { 
                  {{# Parameters }}
                     "{{Key}}" : {{> commonValue }}{{_comma}}
                  {{/ Parameters }} 
             }
    }
}{{_comma}}


</div></div>

<h2><a id="resourceWait.mustache"></a>resourceWait.mustache<a class='navigator' href='#top'> [top]</a></h2>

<p>Creates a WaitHandle, and a WaitCondition on a resource <code>DependsOn</code>.</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Name</code>: </li>
<li><code>DependsOn</code>: Resource on which depents</li>
<li><code>Timeout</code>: The length of time (in seconds) to wait for the number of
signals that the Count property specifies.</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


 "{{Name}}" : {
      "Type" : "AWS::CloudFormation::WaitConditionHandle"
  },

 "{{Name}}Condition" : {
      "Type" : "AWS::CloudFormation::WaitCondition"
      {{> commonDependsOn }}
      , "Properties" : {
            "Handle"  : { "Ref" : "{{Name}}" }
          , "Timeout" : "{{Timeout}}"
      }
    }{{_comma}}


</div></div>

<h2><a id="resourceVPC.mustache"></a>resourceVPC.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Creates a Virtual Private Cloud (VPC) with the CIDR block that you specify.</p>

<p><strong>Attributes</strong>: context=  <code>./resources/InstanceSecurityGroup</code></p>

<ul>
<li><code>Name</code> : of the VPC resource
<ul>
<li><code>CidrBlock</code> or as <a href="#commonKeyValue.mustache">commonKeyValue.mustache</a></li>
<li><code>EnableDnsSupport</code>: (= <strong>true</strong>) Specifies whether DNS resolution
is supported for the VPC. If this attribute is true, the Amazon
DNS server resolves DNS hostnames for your instances to their
corresponding IP addresses; otherwise, it does not.</li>
<li><code>EnableDnsHostnames</code>: (= <strong>true</strong>) Specifies whether the
instances launched in the VPC get DNS hostnames. If this
attribute is true, instances in the VPC get DNS hostnames;
otherwise, they do not. You can only set EnableDnsHostnames to
true if you also set the EnableDnsSupport attribute to true.</li>
<li><code>Tags</code>: (optional) as <a href="#commonKeyValue.mustache">commonKeyValue.mustache</a></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


  "{{Name}}" : {
      "Type" : "AWS::EC2::VPC",
      "Properties" : {
        "CidrBlock" : "{{ CidrBlock }}"
        , "EnableDnsSupport": true
        , "EnableDnsHostnames": true
        , "Tags" : [ {{# Tags }}{{> commonKeyValue }}{{_comma}}{{/ Tags }}]
      }
    }{{_comma}}

</div></div>

<h2><a id="resourceSubnet.mustache"></a>resourceSubnet.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Creates a subnet in an existing VPC.</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Name</code> : of the VPC resource
<ul>
<li><code>CidrBlock</code> or as <a href="#commonKeyValue.mustache">commonKeyValue.mustache</a></li>
<li><code>VpcId</code>: resource name of VPC</li>
<li><code>MapPublicIpOnLaunch</code>: Indicates whether instances that are
launched in this subnet receive a public IP address. By default,
the value is <code>false</code>.</li>
<li><code>Tags</code>: (optional) as <a href="#commonKeyValue.mustache">commonKeyValue.mustache</a></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


  "{{Name}}" : {
   "Type" : "AWS::EC2::Subnet"
    {{> commonDependsOn }}
   , "Properties" : {
         "CidrBlock" : "{{CidrBlock}}"
       , "Tags" : [ {{# Tags }}{{> commonKeyValue }}{{_comma}}{{/ Tags }}]
       , "MapPublicIpOnLaunch" : {{^MapPublicIpOnLaunch}}false{{/ MapPublicIpOnLaunch}}{{# MapPublicIpOnLaunch}}{{MapPublicIpOnLaunch}}{{/ MapPublicIpOnLaunch}}
       , "VpcId" : { "Ref" : "{{VpcId}}" }
   }
}{{_comma}}


</div></div>

<h2><a id="resourceInternetGateway.mustache"></a>resourceInternetGateway.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Creates a new Internet gateway in your AWS account. After creating the
Internet gateway, attach it to a VPC, and create/attach a routetable
to <code>Vpc</code>, and add a routetable entry entry to enable internet
access on <code>Vpc</code> &amp;&amp; <code>Subnet</code></p>

<p><strong>Attributes</strong>: context=  <code>./resources/InstanceSecurityGroup</code></p>

<ul>
<li><code>Name</code> : of the Internet Gateway
<ul>
<li><code>Vpc</code>: reference to VPC where to atttace</li>
<li><code>Subnet</code>: reference to VPC where to attach route to InternetGateway</li>
<li><code>Tags</code>: (optional) as <a href="#commonKeyValue.mustache">commonKeyValue.mustache</a></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


{{! Create internet gateway }}
"{{Name}}" : {
    "Type" : "AWS::EC2::InternetGateway",
    "Properties" : {
       "Tags" : [ {{# Tags }}{{> commonKeyValue }}{{_comma}}{{/ Tags }}]
    }
 },

{{! Attache the internet gateway created to VPC }}
"Attach{{Vpc}}" : {
      "Type" : "AWS::EC2::VPCGatewayAttachment",
      "Properties" : {
        "VpcId" : { "Ref" : "{{Vpc}}" },
        "InternetGatewayId" : { "Ref" : "{{Name}}" }
    }
}, 


{{! Create a route table for VPC }}

"RouteTable{{Vpc}}" : {
      "Type" : "AWS::EC2::RouteTable",
      "Properties" : {
        "VpcId" : { "Ref" : "{{ Vpc }}" },
        "Tags" : [ 
                   {"Key": "Name", "Value" : "RouteTable{{Vpc}}" }
                 , {"Key" : "Application", "Value" : { "Ref" : "AWS::StackId"} } 
                 ]
      }
    },


{{! Add a route to internet gateway created }}

"Route{{Vpc}}" : {
    "Type" : "AWS::EC2::Route",
     "DependsOn" : "Attach{{Vpc}}",
      "Properties" : {
          "RouteTableId" : { "Ref" : "RouteTable{{Vpc}}" }
          , "DestinationCidrBlock" : "0.0.0.0/0"
          , "GatewayId" : { "Ref" : "{{Name}}" }
     }
},

{{! Associates a subnet with a route table. }}

"RouteTableAssociation{{Subnet}}" : {
    "Type" : "AWS::EC2::SubnetRouteTableAssociation"
   , "Properties" : {
         "SubnetId" : { "Ref" : "{{Subnet}}" }
       , "RouteTableId" : { "Ref" : "RouteTable{{Vpc}}" }
     }
}

{{_comma}}



</div></div>

<h2><a id="resourceUser.mustache"></a>resourceUser.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Creates User and AccessKey resources. User resource is associated with a fixed policy.</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Name</code>: of the user resource, derives </li>
<li><code>KeyName</code>: also AccessKey resource for <code>Name</code> user</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>



"{{Name}}":{
    "Type":"AWS::IAM::User",
    "Properties":{
        "Path":"/",
        "Policies":[
            {
                "PolicyName":"root",
                "PolicyDocument":{
                    "Statement":[
                        {
                            "Effect":"Allow",
                            "Action":"cloudformation:DescribeStackResource",
                            "Resource":"*"
                        }
                    ]
                }
            }
        ]
    }
}

{{# KeyName }}
,  "{{KeyName}}":{
      "Type":"AWS::IAM::AccessKey",
       "Properties":{
             "UserName":{
                  "Ref":"{{Name}}"
             }
         }
}
{{/ KeyName }}

{{_comma}}

</div></div>

<h2><a id="output.mustache"></a>output.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Create one output entry to CloudFormation JSON output section</p>

<p><strong>Attributes</strong>: context= <code>./outputs</code></p>

<ul>
<li><code>Name</code> : of the ouput entry</li>
<li><code>Description</code>: of the output entry</li>
<li>one of <strong>Value</strong>, <strong>Ref</strong>, <strong>Attr</strong>
<ul>
<li><code>Value</code>: of the output parameter</li>
<li><code>Ref</code>: name of refernece</li>
<li><code>Attr</code>
<ul>
<li><code>Ref</code>: name of attribute reference</li>
<li><code>Name</code>: name of the attribute</li>
</ul></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

    "{{Name}}": {
      "Description" : "{{Description}}"
      {{#Value}}, "Value" : "{{Value}}"{{/Value}}
      {{#Ref}}, "Value" : { "Ref" : "{{Ref}}" }{{/Ref}}
      {{#Attr}}, "Value" : { "Fn::GetAtt" : [ "{{Ref}}", "{{Name}}" ] }{{/Attr}}
    }{{_comma}}



</div></div>

<h2><a id="commonDependsOn.mustache"></a>commonDependsOn.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p>Common template to output key and value for <code>DependsOn</code></p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>DependsOn</code> : resource name on which dependency defined</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


{{# DependsOn }}, "DependsOn" : "{{DependsOn}}"  {{/ DependsOn }} 


</div></div>

<h2><a id="commonInstanceType.mustache"></a>commonInstanceType.mustache <a class='navigator' href='#top'>[top]</a></h2>

<p>Output value for <code>InstanceType</code> -attribute</p>

<p><strong>Attributes</strong>:</p>

<ul>
<li><code>InstanceType</code>: value of instance type</li>
<li><code>InstanceTypeRef</code>: reference to instance type</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


{{# InstanceType }}"{{ InstanceType }}"{{/ InstanceType }}
{{# InstanceTypeRef }}{ "Ref": "{{ InstanceTypeRef }}" }{{/ InstanceTypeRef }}

</div></div>

<h2><a id="commonCreationPolicy.mustache"></a>commonCreationPolicy.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p>You associate the CreationPolicy attribute with a resource to prevent its status from reaching create complete until AWS CloudFormation receives a specified number of success signals or the timeout period is exceeded. </p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>CreationPolicy</code> : sub document defining creation policy
<ul>
<li><code>Timeout</code>: The value must be in ISO8601 duration format, in the
form: "PT#H#M#S", where each # is the number of hours, minutes,
and seconds, respectively.</li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{{# CreationPolicy }}
   , "CreationPolicy" : {
             "ResourceSignal": {
                   "Timeout": "{{Timeout}}"
             }
   }
{{/ CreationPolicy }} 


</div></div>

<h2><a id="commonCfnSignal.mustache"></a>commonCfnSignal.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p><strong>NOT USED</strong></p>

<p><strike>
Common template to send a signlan</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>WaitHandle</code> : to signal</li>
<li><code>Message</code>    : text message for the signal</li>
</ul>

<p></strike></p>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{{# WaitHandle}}  
   ,    "HANDLE='", { "Ref" : "{{WaitHandle}}" }, "'\n"
   ,   "echo \"Signal success '{{WaitHandle}}' -handle with message '{{Message}}'\" \n"
   ,   "type cfn-signal && sudo cfn-signal --success true --reason \"{{Message}}\" $HANDLE \n"
{{/ WaitHandle}}  


</div></div>

<h2><a id="commonValue.mustache"></a>commonValue.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p>Common template to output value (Value/Ref/Attr/StackRef)</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Value</code> : output value</li>
<li><code>Ref</code>: output Ref</li>
<li><code>StackRef</code>: 
<ul>
<li><code>Stack</code></li>
<li><code>Output</code></li>
</ul></li>
<li><code>Attr</code>: 
<ul>
<li><code>Ref</code></li>
<li><code>Name</code></li>
</ul></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>


{{#Value}}"{{Value}}"{{/Value}}
{{#Ref}}{ "Ref": "{{Ref}}" }{{/Ref}}
{{#Attr}}{ "Fn::GetAtt" : [ "{{Ref}}", "{{Name}}" ] }{{/Attr}}
{{#StackRef}}{ "Fn::GetAtt": [ "{{Stack}}", "Outputs.{{Output}}"] }{{/StackRef}}


</div></div>

<h2><a id="commonKeyValue.mustache"></a>commonKeyValue.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p>Common template to output key-value pair</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Key</code>: </li>
<li>value given as as commonValue, <a href="#commonValue.mustache">commonValue.mustache</a></li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{
   "Key" : "{{Key}}"
   , "Value" : {{> commonValue }}
}


</div></div>

<h2><a id="commonStackRef.mustache"></a>commonStackRef.mustache<a class='navigator' href='#top'>[top]</a></h2>

<p>Common template to output nested stack reference</p>

<p><strong>Attributes</strong>: </p>

<ul>
<li><code>Stack</code> : name of the nested stack resource</li>
<li><code>Output</code>: name of output variable in nested stack</li>
</ul>

<div class='fold'>Check to show template: <input type='checkbox' class='toggle'/><div>

{ "Fn::GetAtt": [ "{{Stack}}", "Outputs.{{Output}}"] }

</div></div>
